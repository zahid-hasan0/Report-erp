<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Merchandising System</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Poppins', sans-serif;
            background: #f0f2f5;
            min-height: 100vh;
        }

        .main-header {
            background: white;
            padding: 25px 0;
            box-shadow: 0 2px 10px rgba(0,0,0,0.08);
            margin-bottom: 40px;
        }

        .header-content {
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 30px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .library-name {
            font-size: 32px;
            font-weight: 700;
            color: #2c3e50;
            margin: 0;
        }

        .btn-manage {
            background: #3498db;
            color: white;
            border: none;
            padding: 12px 30px;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 15px;
        }

        .btn-manage:hover {
            background: #2980b9;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(52, 152, 219, 0.3);
        }

        .buyer-container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 30px;
        }

        .buyer-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 25px;
        }

        .buyer-card {
            background: white;
            border-radius: 12px;
            padding: 35px 25px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            border-left: 5px solid #3498db;
        }

        .buyer-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.15);
        }

        .buyer-card h3 {
            color: #2c3e50;
            font-size: 24px;
            font-weight: 600;
            margin: 0;
        }

        .entry-page {
            display: none;
        }

        .entry-header {
            background: white;
            padding: 25px 0;
            box-shadow: 0 2px 10px rgba(0,0,0,0.08);
            margin-bottom: 40px;
        }

        .entry-header-content {
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 30px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .back-btn {
            background: #95a5a6;
            color: white;
            border: none;
            padding: 10px 25px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .back-btn:hover {
            background: #7f8c8d;
        }

        .buyer-title {
            color: #2c3e50;
            font-size: 28px;
            font-weight: 700;
            margin: 0;
        }

        .entry-content {
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 30px 40px;
        }

        .entry-form {
            background: white;
            padding: 35px;
            border-radius: 12px;
            margin-bottom: 30px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.08);
        }

        .entry-form h4 {
            color: #2c3e50;
            font-weight: 700;
            margin-bottom: 25px;
            font-size: 20px;
        }

        .form-row {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            font-weight: 600;
            color: #34495e;
            margin-bottom: 8px;
            font-size: 14px;
        }

        .form-control {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid #dfe6e9;
            border-radius: 8px;
            font-size: 14px;
            transition: all 0.3s ease;
        }

        .form-control:focus {
            outline: none;
            border-color: #3498db;
            box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.1);
        }

        .btn-submit {
            background: #27ae60;
            color: white;
            border: none;
            padding: 14px 40px;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 15px;
        }

        .btn-submit:hover {
            background: #229954;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(39, 174, 96, 0.3);
        }

        .data-table {
            background: white;
            padding: 35px;
            border-radius: 12px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.08);
            overflow-x: auto;
        }

        .data-table h4 {
            color: #2c3e50;
            font-weight: 700;
            margin-bottom: 25px;
            font-size: 20px;
        }

        table {
            width: 100%;
            border-collapse: collapse;
        }

        table thead {
            background: #ecf0f1;
        }

        table th {
            padding: 15px;
            text-align: left;
            font-weight: 600;
            color: #2c3e50;
            font-size: 13px;
            text-transform: uppercase;
        }

        table td {
            padding: 15px;
            border-bottom: 1px solid #ecf0f1;
            color: #34495e;
            font-size: 14px;
        }

        table tbody tr:hover {
            background: #f8f9fa;
        }

        .no-data {
            text-align: center;
            padding: 50px;
            color: #95a5a6;
        }

        .modal-content {
            border-radius: 12px;
        }

        .modal-header {
            background: #3498db;
            color: white;
            border-radius: 12px 12px 0 0;
        }

        .modal-header .btn-close {
            filter: brightness(0) invert(1);
        }

        .buyer-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 8px;
            margin-bottom: 10px;
        }

        .buyer-item span {
            font-weight: 600;
            color: #2c3e50;
        }

        .btn-group-sm button {
            padding: 6px 15px;
            font-size: 13px;
            border-radius: 5px;
            margin-left: 5px;
            font-weight: 600;
        }

        .btn-edit {
            background: #f39c12;
            color: white;
            border: none;
        }

        .btn-edit:hover {
            background: #e67e22;
        }

        .btn-delete {
            background: #e74c3c;
            color: white;
            border: none;
        }

        .btn-delete:hover {
            background: #c0392b;
        }

        @media (max-width: 768px) {
            .header-content,
            .entry-header-content {
                flex-direction: column;
                gap: 15px;
            }

            .buyer-grid {
                grid-template-columns: 1fr;
            }

            .form-row {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <!-- Buyer Selection Page -->
    <div id="buyerSelectionPage">
        <div class="main-header">
            <div class="header-content">
                <h1 class="library-name">Merchandising System</h1>
                <button class="btn-manage" data-bs-toggle="modal" data-bs-target="#manageBuyerModal">
                    Manage Buyers
                </button>
            </div>
        </div>

        <div class="buyer-container">
            <div class="buyer-grid" id="buyerGrid">
                <!-- Buyer cards will be generated here -->
            </div>
        </div>
    </div>

    <!-- Entry Page -->
    <div id="entryPage" class="entry-page">
        <div class="entry-header">
            <div class="entry-header-content">
                <button class="back-btn" onclick="goBackToBuyers()">‚Üê Back</button>
                <h1 class="buyer-title" id="buyerTitle">Buyer Name</h1>
                <div></div>
            </div>
        </div>

        <div class="entry-content">
            <div class="entry-form">
                <h4>Add New Entry</h4>
                <form id="entryForm">
                    <div class="form-row">
                        <div class="form-group">
                            <label>Date</label>
                            <input type="date" class="form-control" id="entryDate" required>
                        </div>
                        <div class="form-group">
                            <label>Style</label>
                            <input type="text" class="form-control" id="entryStyle" placeholder="ST-101" required>
                        </div>
                        <div class="form-group">
                            <label>PO</label>
                            <input type="text" class="form-control" id="entryPO" placeholder="PO-5001" required>
                        </div>
                        <div class="form-group">
                            <label>Color</label>
                            <input type="text" class="form-control" id="entryColor" placeholder="Red, Blue" required>
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label>Quantity (PCS)</label>
                            <input type="number" class="form-control" id="entryQty" placeholder="5000" required>
                        </div>
                        <div class="form-group">
                            <label>Excess/Short</label>
                            <input type="text" class="form-control" id="entryExcess" placeholder="+50 or -30">
                        </div>
                        <div class="form-group">
                            <label>Remarks</label>
                            <input type="text" class="form-control" id="entryRemarks" placeholder="Optional">
                        </div>
                    </div>

                    <button type="submit" class="btn-submit">Save Entry</button>
                </form>
            </div>

            <div class="data-table">
                <h4>Entry Records</h4>
                <table>
                    <thead>
                        <tr>
                            <th>Date</th>
                            <th>Style</th>
                            <th>PO</th>
                            <th>Color</th>
                            <th>Quantity</th>
                            <th>Excess/Short</th>
                            <th>Remarks</th>
                            <th>Action</th>
                        </tr>
                    </thead>
                    <tbody id="tableBody">
                        <tr>
                            <td colspan="8" class="no-data">No entries yet</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <!-- Manage Buyer Modal -->
    <div class="modal fade" id="manageBuyerModal" tabindex="-1">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Manage Buyers</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <div class="mb-4">
                        <h6 class="mb-3">Add New Buyer</h6>
                        <div class="input-group">
                            <input type="text" class="form-control" id="newBuyerName" placeholder="Enter buyer name">
                            <button class="btn btn-primary" onclick="addBuyer()">Add Buyer</button>
                        </div>
                    </div>

                    <h6 class="mb-3">Existing Buyers</h6>
                    <div id="buyerList"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- Edit Buyer Modal -->
    <div class="modal fade" id="editBuyerModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Edit Buyer</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <input type="hidden" id="editBuyerOldName">
                    <div class="form-group">
                        <label>Buyer Name</label>
                        <input type="text" class="form-control" id="editBuyerName">
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                    <button type="button" class="btn btn-primary" onclick="saveBuyerEdit()">Save Changes</button>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        let buyers = ['Zara', 'H&M', 'GAP', 'Uniqlo', 'Next', 'Primark', 'M&S', 'C&A'];
        let currentBuyer = '';

        // Load buyers from localStorage
        function loadBuyers() {
            const saved = localStorage.getItem('buyers');
            if (saved) {
                buyers = JSON.parse(saved);
            }
        }

        // Save buyers to localStorage
        function saveBuyersToStorage() {
            localStorage.setItem('buyers', JSON.stringify(buyers));
        }

        // Initialize buyer cards
        function initBuyerCards() {
            const grid = document.getElementById('buyerGrid');
            grid.innerHTML = '';

            buyers.forEach(buyer => {
                const card = document.createElement('div');
                card.className = 'buyer-card';
                card.onclick = () => openBuyerPage(buyer);
                card.innerHTML = `<h3>${buyer}</h3>`;
                grid.appendChild(card);
            });
        }

        // Display buyer list in modal
        function displayBuyerList() {
            const list = document.getElementById('buyerList');
            list.innerHTML = '';

            buyers.forEach((buyer, index) => {
                const item = document.createElement('div');
                item.className = 'buyer-item';
                item.innerHTML = `
                    <span>${buyer}</span>
                    <div class="btn-group-sm">
                        <button class="btn-edit" onclick="editBuyer('${buyer}')">Edit</button>
                        <button class="btn-delete" onclick="deleteBuyer('${buyer}')">Delete</button>
                    </div>
                `;
                list.appendChild(item);
            });
        }

        // Add new buyer
        function addBuyer() {
            const name = document.getElementById('newBuyerName').value.trim();
            if (name && !buyers.includes(name)) {
                buyers.push(name);
                saveBuyersToStorage();
                document.getElementById('newBuyerName').value = '';
                displayBuyerList();
                initBuyerCards();
            } else if (buyers.includes(name)) {
                alert('Buyer already exists!');
            } else {
                alert('Please enter a buyer name!');
            }
        }

        // Edit buyer
        function editBuyer(buyer) {
            document.getElementById('editBuyerOldName').value = buyer;
            document.getElementById('editBuyerName').value = buyer;
            new bootstrap.Modal(document.getElementById('editBuyerModal')).show();
        }

        // Save buyer edit
        function saveBuyerEdit() {
            const oldName = document.getElementById('editBuyerOldName').value;
            const newName = document.getElementById('editBuyerName').value.trim();
            
            if (newName && newName !== oldName) {
                const index = buyers.indexOf(oldName);
                if (index !== -1) {
                    buyers[index] = newName;
                    
                    // Update entries
                    for (let i = 0; i < localStorage.length; i++) {
                        const key = localStorage.key(i);
                        if (key.startsWith('entry_' + oldName + '_')) {
                            const entry = JSON.parse(localStorage.getItem(key));
                            entry.buyer = newName;
                            localStorage.removeItem(key);
                            const newKey = key.replace('entry_' + oldName + '_', 'entry_' + newName + '_');
                            localStorage.setItem(newKey, JSON.stringify(entry));
                        }
                    }
                    
                    saveBuyersToStorage();
                    displayBuyerList();
                    initBuyerCards();
                    bootstrap.Modal.getInstance(document.getElementById('editBuyerModal')).hide();
                }
            }
        }

        // Delete buyer
        function deleteBuyer(buyer) {
            if (confirm(`Are you sure you want to delete ${buyer}? All entries will be removed.`)) {
                buyers = buyers.filter(b => b !== buyer);
                
                // Delete all entries
                for (let i = localStorage.length - 1; i >= 0; i--) {
                    const key = localStorage.key(i);
                    if (key.startsWith('entry_' + buyer + '_')) {
                        localStorage.removeItem(key);
                    }
                }
                
                saveBuyersToStorage();
                displayBuyerList();
                initBuyerCards();
            }
        }

        // Open buyer entry page
        function openBuyerPage(buyer) {
            currentBuyer = buyer;
            document.getElementById('buyerSelectionPage').style.display = 'none';
            document.getElementById('entryPage').style.display = 'block';
            document.getElementById('buyerTitle').textContent = buyer;
            document.getElementById('entryDate').value = new Date().toISOString().split('T')[0];
            loadBuyerEntries(buyer);
        }

        // Go back to buyers
        function goBackToBuyers() {
            document.getElementById('buyerSelectionPage').style.display = 'block';
            document.getElementById('entryPage').style.display = 'none';
            document.getElementById('entryForm').reset();
        }

        // Load buyer entries
        function loadBuyerEntries(buyer) {
            const tbody = document.getElementById('tableBody');
            const entries = [];

            for (let i = 0; i < localStorage.length; i++) {
                const key = localStorage.key(i);
                if (key.startsWith('entry_' + buyer + '_')) {
                    entries.push(JSON.parse(localStorage.getItem(key)));
                }
            }

            if (entries.length === 0) {
                tbody.innerHTML = '<tr><td colspan="7" class="no-data">No entries yet</td></tr>';
                return;
            }

            entries.sort((a, b) => new Date(b.date) - new Date(a.date));

            tbody.innerHTML = entries.map(entry => `
                <tr>
                    <td>${new Date(entry.date).toLocaleDateString()}</td>
                    <td>${entry.style}</td>
                    <td>${entry.po}</td>
                    <td>${entry.color}</td>
                    <td>${parseInt(entry.qty).toLocaleString()}</td>
                    <td>${entry.excess || '-'}</td>
                    <td>${entry.remarks || '-'}</td>
                </tr>
            `).join('');
        }

        // Form submit
        document.getElementById('entryForm').addEventListener('submit', (e) => {
            e.preventDefault();

            const entry = {
                buyer: currentBuyer,
                date: document.getElementById('entryDate').value,
                style: document.getElementById('entryStyle').value,
                po: document.getElementById('entryPO').value,
                color: document.getElementById('entryColor').value,
                qty: document.getElementById('entryQty').value,
                excess: document.getElementById('entryExcess').value,
                remarks: document.getElementById('entryRemarks').value,
                timestamp: Date.now()
            };

            const key = `entry_${currentBuyer}_${entry.timestamp}`;
            localStorage.setItem(key, JSON.stringify(entry));

            alert('Entry saved successfully!');
            document.getElementById('entryForm').reset();
            document.getElementById('entryDate').value = new Date().toISOString().split('T')[0];
            loadBuyerEntries(currentBuyer);
        });

        // Modal event listeners
        document.getElementById('manageBuyerModal').addEventListener('show.bs.modal', displayBuyerList);

        // Initialize
        loadBuyers();
        initBuyerCards();
    </script>
</body>
</html>