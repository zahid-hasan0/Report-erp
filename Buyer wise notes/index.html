<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Merchandise Item Notes</title>
    <!-- Google Fonts: Inter -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.0/font/bootstrap-icons.css">

    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>
    <link rel="stylesheet" href="style.css">
</head>

<body>
    <!-- Toast Container -->
    <div class="toast-container position-fixed top-0 end-0 p-3" style="z-index: 10000;" id="toastContainer"></div>

    <!-- Delete Confirmation Modal -->
    <div class="modal fade" id="deleteModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content glass-modal">
                <div class="modal-header border-0">
                    <h5 class="modal-title text-danger"><i class="bi bi-exclamation-triangle-fill me-2"></i>Confirm
                        Delete</h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"
                        aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <p>Are you sure you want to delete this item? This action cannot be undone.</p>
                </div>
                <div class="modal-footer border-0">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                    <button type="button" class="btn btn-danger" id="confirmDeleteBtn">Delete Item</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Loading Overlay -->
    <div class="loader-overlay" id="loader">
        <div class="loader-content">
            <div class="spinner-border text-primary" role="status"></div>
            <h5 class="mt-3" id="loaderText">Loading...</h5>
        </div>
    </div>

    <div class="firebase-status glass-status" id="firebaseStatus">
        <i class="bi bi-cloud-fill status-connected"></i> <span id="statusText">Connecting...</span>
    </div>

    <div id="mainPage">
        <div class="container-fluid px-4 py-4">
            <div class="main-container glass-panel">
                <div class="page-header d-flex justify-content-between align-items-center flex-wrap gap-3">
                    <div class="brand-section">
                        <div class="brand-icon">

                        </div>
                        <div>
                            <h1 class="h4 mb-0 fw-bold">Merchandise Item Notes</h1>
                            <p class="text-muted small mb-0">Tracking Notes for Merchandise Booking Items</p>
                        </div>
                    </div>

                    <div class="action-buttons d-flex flex-wrap gap-2">
                        <label for="fileInput" class="btn btn-glass btn-sm">
                            <i class="bi bi-upload me-2"></i>Upload Excel
                        </label>
                        <input type="file" id="fileInput" accept=".xlsx,.xls,.csv" style="display: none;">

                        <button type="button" class="btn btn-glass btn-sm" id="downloadBtn">
                            <i class="bi bi-download me-2"></i>Download
                        </button>
                        <button type="button" class="btn btn-glass btn-sm" id="printBtn">
                            <i class="bi bi-printer me-2"></i>Print
                        </button>
                        <button type="button" class="btn btn-primary-gradient btn-sm" id="addNewBtn">
                            <i class="bi bi-plus-lg me-2"></i>New Item
                        </button>
                    </div>
                </div>

                <div class="filters-section row g-3 mb-4">
                    <div class="col-md-6">
                        <div class="search-box">
                            <input type="text" class="form-control" id="searchInput"
                                placeholder="Search by buyer, description, or code...">
                        </div>
                    </div>
                    <div class="col-md-6">
                        <select class="form-select" id="buyerFilter">
                            <option value="">All Buyers</option>
                        </select>
                    </div>
                </div>

                <!-- Stats Cards -->
                <div class="row g-3 mb-4 stats-row">
                    <div class="col-md-6 col-lg-3">
                        <div class="stat-card">
                            <div class="icon-box bg-indigo-light text-indigo">
                                <i class="bi bi-collection-fill"></i>
                            </div>
                            <div>
                                <h6 class="text-muted mb-0">Total Items</h6>
                                <h3 class="fw-bold mb-0" id="totalItems">0</h3>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-6 col-lg-3">
                        <div class="stat-card">
                            <div class="icon-box bg-emerald-light text-emerald">
                                <i class="bi bi-people-fill"></i>
                            </div>
                            <div>
                                <h6 class="text-muted mb-0">Active Buyers</h6>
                                <h3 class="fw-bold mb-0" id="totalBuyers">0</h3>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="table-container custom-scrollbar">
                    <table class="table custom-table">
                        <thead>
                            <tr>
                                <th>#</th>
                                <th>Buyer Name</th>
                                <th>Description</th>
                                <th>TPC Code</th>
                                <th>Logic / Notes</th>
                                <th>Logic Description</th>
                                <th>Comments</th>
                                <th class="text-center">Actions</th>
                            </tr>
                        </thead>
                        <tbody id="itemsTableBody">
                            <tr>
                                <td colspan="8" class="text-center py-5 text-muted">
                                    <div class="spinner-border spinner-border-sm text-primary" role="status"></div>
                                    <p class="mt-2 small">Syncing data...</p>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <!-- Entry Form Page (Overlay) -->
    <div class="entry-page glass-overlay" id="entryPage">
        <div class="container h-100 d-flex justify-content-center align-items-center">
            <div class="form-card glass-panel col-md-8 col-lg-6">
                <div class="modal-header border-0 mb-4 d-flex justify-content-between align-items-center">
                    <div>
                        <h3 class="fw-bold mb-0" id="formTitle">Add New Item</h3>
                        <p class="text-muted small mb-0">Enter the details below</p>
                    </div>
                    <button type="button" class="btn-close-custom" id="closeFormBtn">
                        <i class="bi bi-x-lg"></i>
                    </button>
                </div>

                <div class="modal-body custom-scrollbar" style="max-height: 70vh; overflow-y: auto;">
                    <div class="mb-3">
                        <label for="buyerName" class="form-label">Buyer Name <span class="text-danger">*</span></label>
                        <input type="text" class="form-control" id="buyerName" placeholder="Buyer Name">
                    </div>
                    <div class="mb-3">
                        <label for="description" class="form-label">Description</label>
                        <textarea class="form-control" id="description" rows="2"
                            placeholder="Item description"></textarea>
                    </div>
                    <div class="row">
                        <div class="col-md-6 mb-3">
                            <label for="tpcLogic" class="form-label">TPC code</label>
                            <input type="text" class="form-control" id="tpcLogic" placeholder="TPC Logic">
                        </div>
                        <div class="col-md-6 mb-3">
                            <label for="logicCode" class="form-label">Logic/ Notes</label>
                            <input type="text" class="form-control" id="logicCode" placeholder="Logic/ Notes">
                        </div>
                    </div>
                    <div class="mb-3">
                        <label for="logicDescription" class="form-label">Logic Description</label>
                        <textarea class="form-control" id="logicDescription" rows="2" placeholder="Details"></textarea>
                    </div>
                    <div class="mb-3">
                        <label for="comments" class="form-label">Comments</label>
                        <textarea class="form-control" id="comments" rows="2"
                            placeholder="Additional notes..."></textarea>
                    </div>
                </div>

                <div class="modal-footer border-0 mt-4 d-flex gap-2 justify-content-end">
                    <button type="button" class="btn btn-glass" id="cancelBtn">Cancel</button>
                    <button type="button" class="btn btn-primary-gradient px-4" id="saveBtn">
                        <span id="saveButtonText">Save Item</span>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Bootstrap JS Bundle -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="script.js"></script>
</body>

</html>